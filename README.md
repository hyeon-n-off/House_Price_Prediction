# House Price Prediction | `2024.03.20 - 2024.04.02`
[머신러닝 / 회귀] 서울 아파트의 실거래가를 예측하는 모델을 개발 

<br>

## Summary

### 🛠️ 목표
정확하고 일반화된 모델을 개발하여 아파트 시장의 동향을 미리 예측하는 것이다. 이를 통해 부동산 관련 의사 결정을 돕고, 효율적인 거래를 촉진할 수 있다. <br>
또한, 정부의 입장에서는 시세 모니터링 및 비정상적인 부정거래를 탐지할 수 있다. <br>

### ⚙️ 수행 역할
- **데이터 전처리**
    - **결측치 처리**: EDA를 통하여 각 column의 특성을 파악하고, 그에 맞게 결측치 처리 (e.g. Linear 모델 적용, 웹 크롤링 등)
    - **Feature 전처리 및 생성**:
        - 건설사명 및 아파트명과 같은 column들을 **범주화**하여 더욱 의미있는 정보 추출
        - 아파트의 위치 정보와 주변 초등학교 및 지하철역의 위치 정보를 사용하여 '주변 초등학교 유무', '주변 지하철역 유무' 등과 같은 column들을 생성
- **모델 학습 및 앙상블**
    - Optuna를 사용하여 각 모델마다 최적의 파라미터를 찾아 적용하였고, 최적의 예측 성능을 위한 앙상블 기법을 적용

### 📈 결과 및 직무에 적용할 점
1. **모델 성능 향상**: 다양한 모델과 앙상블 기법을 통해 예측 성능을 극대화할 수 있는 전략을 개발
2. **EDA의 중요성**: EDA를 통한 Feature Engineering으로 모델의 성능을 효과적으로 향상시킬 수 있음을 확인
3. **부동산 시장 이해 증진**: 서울 아파트 시장의 가격 변동성을 이해하고, 이를 기반으로 한 데이터 기반의 의사결정 능력을 향상

<br>

## 프로젝트 상세
### 📝 데이터 설명
  - 데이터 형태: .csv 형식의 파일
  - 데이터 기간: train data(`2007.01.01 - 2023.06.30`), test data(`2023.07.01 - 2023.09.26`)
  - 데이터 개수: 52개의 columns, (train data(1,118,822 rows), test data(9,272 rows))
  - 제공된 외부 데이터: 서울시 지하철 역, 버스 정류장에 대한 데이터

### 📊 EDA
<span style="color:#808080"> 모든 Column에 대한 EDA는 [여기](https://fish-target-b61.notion.site/AI-Stage-House-Price-Prediction-734b395d36ce4cefa80b84c2b5dfd933)를 참조해주세요. </span>

### 🔍 데이터 전처리
  - 1. **시군구**
       
    ![image](https://github.com/user-attachments/assets/a47170bb-cb4f-416d-bcc1-48c3fdb9ff50)

    평균 실거래가가 높은 구는 `강남구, 서초구, 용산구`로 확인. 위 3개의 구에 해당하면 1, 아니라면 0을 부여한 **강남 여부** 특성 생성
    
  - 2. **k-건설사**
   
    ![image](https://github.com/user-attachments/assets/a77c7be1-29a6-40d7-9a7b-204de35a2dfa)

    해당 Column에는 345개의 Unique한 건설사 이름이 존재. 또한 같은 회사임에도 영어와 한글이 혼용되어 사용되는 경우도 있다. (e.g. `GS건설, 지에스 건설`) <br>
    따라서 특정 회사 단어를 기준으로 묶어 범주화하여 정보를 축소 (결측치는 'NULL'로 처리) <br>
    결과적으로 345개에서 136개의 건설사로 줄임

  - 3. **지하철 위치 정보**
    
    subway_feature.csv에는 지하철역의 이름과 위치정보(위도, 경도)가 저장되어 있다. <br>
    
    **Geocoding(google maps api)를 사용**
    
      train, test dataset에는 X, Y 좌표 결측치가 80만개 이상 존재. 상대적으로 결측치가 적은 `시군구`와 `번지` Column을 이용하여 `지번주소` Column을 생성 (e.g. `서초 포레스타 2단지` --> `서울특별시 서초구 내곡동 384`)  <br>
    
    이를 통해 **근처 지하철역 여부**, **근처 지하철역 이름** 등의 새로운 column 생성

  - 4. **초등학교 위치 정보**
  
    역세권과 마찬가지로 주변 초등학교 여부가 target에 유의미한 영향을 끼칠 것이라고 예상 <br>
    따라서, [공공포털데이터](https://www.data.go.kr/data/15021148/standard.do)에서 정보를 가져와 위와 동일한 전처리 진행

  - 5. **아파트명**

    ![image](https://github.com/user-attachments/assets/c9ef1b85-bb95-4a7b-a79a-56672bab26a5)
    ![image](https://github.com/user-attachments/assets/b8453055-d22d-4886-b22a-7640df5e603a)

    아파트 브랜드가 부동산 가격에 영향이 있을 것이라고 예상하였다. 따라서, `브랜드아파트유무` Column을 생성

    
### 🧠 모델링

  - 📐 **평가지표**
    - RMSE(Root Mean Squared Error) <br>
    
      <img src="https://github.com/user-attachments/assets/7d730f13-b8b6-46af-b082-46f53756a97c" width="30%">

  - **모델 구성**
    1. **모델 별 성능 평가(Baseline)**

      <div align="center">

      | 모델명     | Public LB      |
      |----------|-----------------|
      | XGBoost | 24163.5940 |
      | LGBM | 30403.3131 |
      | CatBoost | 22097.2588 |
      
      </div>

    2. **하이퍼 파라미터 튜닝**

        - Optuna로 하이퍼 파라미터 튜닝 진행
        - 또한 전체 Columns 중 Feature Importance가 높은 상위 15개의 Columns만 택함

       <br>
       
      <div align="center">
      
      | 모델명     | 튜닝 전      | 튜닝 후      |
      |----------|-----------------|----------|
      | XGBoost | 24163.5940 | 18271.0504 |
      | CatBoost | 22097.2588 | 20085.8715 |
      
      </div>
      
    3. **모델 앙상블**

        - 성능이 좋게 나온 CatBoost와 XGBoost을 앙상블을 진행할 모델로 선정하였다. <br>

       <br>

      <div align="center">
      
      | 모델명     | Public LB    |
      |----------|-----------------|
      | XGBoost + CatBoost | 16717.9486 |
      | XGBoost | 18271.0504 |
      | CatBoost | 20085.8715 |
      
      </div>

  - **결과**
    - XGBoost와 CatBoost를 앙상블하였을 때 가장 좋은 성능을 보여줌
   
### 🎯 결과 및 기대효과

  - **시장 분석**: 복합적인 가격 결정 요인들을 종합적으로 해석하여 부동산 시장의 다양한 특성을 이해하고, 시장 동향을 예측할 수 있다.
  - **의사 결정 지원**: 예측 결과를 활용하여 구매자 및 판매자가 더욱 합리적인 의사결정을 할 수 있도록 지원, 정부의 부동산 정책 수립 및 시세 모니터링에 유용한 데이터를 제공할 수 있다.
